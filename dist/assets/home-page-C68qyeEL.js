import{u as f,r as u,j as e,c as m,a as j,L as v,g as y}from"./index-BmMFpa1e.js";import{P as b,a as P,b as w,c as N,S as p}from"./product-card-image-BQJNy0bR.js";import{P as C,B as S,a as I,b as E}from"./api-client-rh98yawT.js";const h={priceAsc:"price",priceDesc:"-price"},g={sortBy:"sort_by"},L=({className:t,...r})=>{const[s,o]=f(),[a,i]=u.useState(()=>s.get(g.sortBy)??"");return u.useEffect(()=>{const c=s.get(g.sortBy)??"";i(c)},[s]),u.useEffect(()=>{const c=new URLSearchParams(s);a?c.set(g.sortBy,a):c.delete(g.sortBy),o(c)},[a]),e.jsxs("select",{className:m("cursor-pointer rounded-xl bg-neutral-950/20 p-4 text-lg font-bold capitalize shadow-sm shadow-neutral-800 duration-200 hover:scale-[1.02] hover:bg-neutral-800",t),value:a,onChange:c=>i(c.target.value),...r,children:[e.jsx("option",{value:"",children:"Sort by"}),e.jsx("option",{value:h.priceAsc,children:"Price asc ⬆️"}),e.jsx("option",{value:h.priceDesc,children:"Price desc ⬇️"})]})},B=({categories:t,isLoading:r,isError:s,className:o,...a})=>e.jsxs("div",{className:m("flex justify-between gap-10 max-md:flex-col max-md:gap-5 md:items-center",o),...a,children:[e.jsx(A,{categoriesSet:t,isLoading:r,isError:s}),e.jsx(L,{})]}),k=t=>{const[r,s]=u.useState(0),[o,a]=f(),i=[...t||[]],c=l=>{const d=i[l];s(l);const n=new URLSearchParams(o);n.set("category",d),a(n)};return u.useEffect(()=>{const l=o.get("category");if(l){const d=i.findIndex(n=>n===l);d!==-1&&s(d)}else s(0)},[o,i]),{categories:i,activeIndex:r,onCategoryItemClick:c}},F=({count:t=5,className:r,...s})=>e.jsx("ul",{className:m("flex items-center gap-5",r),role:"tablist",...s,children:Array.from({length:t}).map((o,a)=>e.jsx("li",{className:"h-15 w-30 animate-pulse rounded-xl bg-neutral-800/50",role:"tab","aria-disabled":"true"},a))}),A=({categoriesSet:t,className:r,isLoading:s,isError:o,...a})=>{const{categories:i,activeIndex:c,onCategoryItemClick:l}=k(t);return s?e.jsx(F,{count:5,className:r,...a}):o?e.jsx("p",{children:"Failed to load categories. Try again later."}):e.jsx("ul",{className:m("flex w-full items-center gap-5 overflow-x-auto overflow-y-hidden max-lg:max-w-[700px]",r),role:"tablist",...a,children:i.map((d,n)=>e.jsx("li",{className:m("cursor-pointer rounded-xl bg-neutral-950/20 p-4 text-lg font-bold text-nowrap capitalize shadow-sm shadow-neutral-800 duration-200 hover:scale-[1.02] hover:bg-neutral-800",c===n&&"bg-neutral-700 hover:bg-neutral-700"),onClick:()=>l(n),onKeyDown:x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),l(n))},role:"tab","aria-selected":c===n,tabIndex:0,children:d},d))})},R=({item:t,className:r,...s})=>{const{itemQuantities:o,handleProductQuantity:a,removeProduct:i}=j();return e.jsxs("article",{className:m("flex flex-1 flex-col",r),...s,children:[e.jsxs(v,{to:y(t.id),children:[e.jsx(b,{src:t.image,width:250,height:250,alt:t.title}),e.jsxs("div",{className:"flex flex-col px-2 py-4",children:[e.jsx(P,{className:"mb-3 line-clamp-2 text-xl",children:t.title}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"inline-flex items-center gap-1",children:["Category:",e.jsx(w,{children:t.category})]}),e.jsxs("div",{className:"inline-flex items-center gap-1",children:["Rating: ",e.jsx(C,{rating:t.rating})]}),e.jsxs("div",{className:"inline-flex items-center gap-1",children:["Price: ",e.jsxs(N,{children:[t.price,"$"]})]})]})]})]}),e.jsxs("div",{className:"mt-auto flex items-center justify-between gap-4 p-2",children:[e.jsx(S,{item:t}),e.jsx(I,{itemId:t.id})]})]})},D=({className:t,...r})=>e.jsxs("div",{className:m("flex animate-pulse flex-col rounded-md bg-neutral-900/30 p-0.5 shadow-md shadow-neutral-800",t),...r,children:[e.jsx("div",{className:"h-60 w-full rounded-md bg-neutral-700"}),e.jsxs("div",{className:"flex flex-col gap-2 px-2 py-4",children:[e.jsx("div",{className:"h-5 w-3/4 rounded bg-neutral-700"}),e.jsx("div",{className:"h-4 w-1/2 rounded bg-neutral-700"}),e.jsx("div",{className:"h-4 w-1/3 rounded bg-neutral-700"}),e.jsx("div",{className:"h-4 w-1/4 rounded bg-neutral-700"})]}),e.jsxs("div",{className:"mt-7 flex items-center justify-between gap-4 p-2",children:[e.jsx("div",{className:"h-10 w-24 rounded bg-neutral-700"}),e.jsx("div",{className:"h-10 w-20 rounded bg-neutral-700"})]})]}),T=t=>{const[r]=f(),s=r.get("category"),o=r.get(g.sortBy),a=s&&s!=="all"?t.filter(c=>c.category===s):t;return u.useMemo(()=>o===h.priceAsc?a.toSorted((c,l)=>c.price-l.price):o===h.priceDesc?a.toSorted((c,l)=>l.price-c.price):a,[a,o])},$=({items:t,title:r=`Items (${t.length})`,isLoading:s,isError:o,className:a,...i})=>{const c=T(t),l=u.useMemo(()=>Array.from({length:8}).map((d,n)=>e.jsx(D,{},n)),[]);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mb-8 text-4xl font-bold",children:o?"Failed to load items. Try again later.":`Items (${c.length})`||`(${r})`}),e.jsx("div",{className:m("",a),...i,children:e.jsx("ul",{className:"grid grid-cols-4 gap-x-5 gap-y-10 max-xl:grid-cols-3 max-lg:grid-cols-2 max-sm:grid-cols-1",children:s?l:c.map(d=>e.jsx("li",{className:"flex h-full flex-col rounded-md bg-neutral-950/20 p-0.5 shadow-md shadow-neutral-800 duration-200 hover:scale-[1.02] hover:bg-neutral-800",children:e.jsx(R,{item:d})},d.id))})})]})},H=()=>{const[t,r]=u.useState([]),[s,o]=u.useState(!0),[a,i]=u.useState(!1),[c,l]=u.useState();return u.useEffect(()=>{(async()=>{try{o(!0);const n=await E.products.getAllProducts();l(new Set(["all",...n.map(x=>x.category)])),r(n)}catch(n){console.log("Error to fetch products HomePage fetchItems",n),i(!0),r([])}finally{o(!1)}})()},[]),{items:t,isLoading:s,isError:a,categories:c}};function Q(){const{items:t,isLoading:r,isError:s,categories:o}=H();return e.jsxs("div",{className:"mt-5 flex flex-col gap-4",children:[e.jsx(p,{children:e.jsx(B,{categories:o,isLoading:r,isError:s})}),e.jsx(p,{children:e.jsx($,{items:t,isLoading:r,isError:s})})]})}export{Q as default};
